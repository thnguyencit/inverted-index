ABSTRACT
TÓM TẮT
Phát hiện phổ quần thể rầy nâu trong ảnh có thể được kết hợp với các hệ thống bẫy đèn để tự động hóa việc đếm số lượng rầy nâu vào bẫy đèn, vốn đang được thực hiện một cách thủ công. Ứng dụng này sẽ mang lại nhiều lợi ích thiết thực cho nhà nông nhằm hỗ trợ giám sát các loài sâu bệnh trong nông nghiệp. Một trong những vấn đề trong việc phát hiện phổ quần thể trong các ảnh chụp từ bẫy đèn là có sự xuất hiện của các loại công trùng khác như bướm, sâu bọ,... trong ảnh, làm giảm độ chính xác của các phương pháp phát hiện quần thể rầy nâu. Trong nghiên cứu này, chúng tôi sẽ đề xuất một phương pháp nhằm khử các tác nhân này trong ảnh để tăng độ chính xác trong việc phát hiện quần thể rầy nâu. Phương pháp này được sử dụng để loại bỏ các loài côn trùng không phải rầy nâu xuất hiện trong ảnh nhờ vào đặc trưng màu sắc và kích thước của rầy nâu. Kết quả thực nghiêm cho thấy, các phương pháp được đề xuất có thể ngăn được tác động của các tác nhân gây nhiễu này lên kết quả của việc phát hiện quần thể rầy nâu trong ảnh.
   1 GIỚI THIỆU 
   Rầy nâu là một trong những loài sâu bệnh nguy hiểm trên lúa gây tổn hại cho nền nông nghiệp của nước ta cũng như các nước trồng lúa khác trên thế giới [1]. Chúng là tác nhân truyền nhiễm các loại bệnh trên lúa nên việc giám sát sự di cư của rầy nâu giúp hạn chế các tổn hại mà chúng gây ra. Từ lý do trên thì đã có nhiều phương pháp khác nhau để hạn chế tác hại của rầy nâu như sử dụng các giống lúa kháng rầy để phòng tránh rầy nâu như nghiên cứu bản đồ gene có khả năng kháng rầy từ sự pha trộn hai giống lúa kháng rầy đã được cải tiến là IR64 và Azucena để tìm ra các định lượng tính trạng (QTLs) dùng cho phòng tránh rầy nâu [2]. Một nghiên cứu khác cũng liên quan tới việc tạo ra bản đồ gene phòng tránh rầy nâu dựa trên sự kết hợp hai giống lúa kháng rầy là 'B5' và 'Minghui 63' [3]. Phương pháp này có ưu điểm là mang lại hiệu quả kháng rầy cao nhưng có khả năng làm thay đổi đặc tính của giống lúa. Hướng nghiên cứu thứ hai dựa trên các đặc tính của cây lúa để phát hiện rầy nâu như nghiên cứu sử dụng hệ số phản xạ (reflectance) và hàm lượng diệp lục tố (SPAD reading) trên cây lúa để phát hiện mức độ nhiễm rầy [4] hoặc nghiên cứu phát hiện mật độ nhiễm rầy dựa vào các yếu tố môi trường như nhiệt độ, lượng mưa, độ ẩm tương đối [5], phương pháp này mở ra một hướng tiếp cận mới trong vấn đề phát hiện và giám sát rầy nâu nhưng cần có thời gian thực nghiệm và phân tích mối liên hệ giữa các yếu tố để xem xét tính hiệu quả. Hướng nghiên cứu thứ ba là phát hiện rầy nâu trong ảnh dựa trên xử lý tín hiệu hình ảnh như nghiên cứu ảnh hưởng của rầy nâu dựa vào ảnh cây lúa [6], nghiên cứu về thiết kế hệ thống phát hiện rầy nâu dựa trên xử lý tín hiệu số [7]. 
   Trong bài viết này, chúng tôi sẽ tìm hiểu một nghiên cứu về việc xây dựng mô hình phát hiện phổ quần thể rầy nâu trong ảnh dựa trên tiếp cận xử lý ảnh hình thái (mathematical morphology) [8]. Với cách tiếp cận này sẽ giúp phát hiện phổ quần thể rầy nâu trong ảnh dựa trên các đặc trưng về hình dạng và kích thước của rầy nâu. Ngoài ra, phương pháp này còn có ưu điểm là ứng dụng được công nghệ thông tin giúp tự động hóa quá trình giám sát rầy nâu. Kết quả thực nghiệm của mô hình này cho thấy đây là một phương pháp có triển vọng cho việc phát hiện quần thể rầy nâu một cách tự động từ các ảnh chụp trong bẫy đèn. Tuy nhiên, mô hình này vẫn còn hạn chế trong trường hợp có sự xuất hiện các loài côn trùng không phải rầy nâu trong ảnh sẽ làm ảnh hưởng đến độ chính xác của giải thuật. 
   Để khắc phục nhược điểm trên, chúng tôi sẽ đề xuất một phương pháp giúp loại bỏ nhiễu trong ảnh rầy nâu, cụ thể là loại bỏ các loài côn trùng không phải rầy nâu trong ảnh - giúp tăng độ chính xác của giải thuật phát hiện phổ quần thể rầy nâu dựa trên xử lý ảnh hình thái. Phương pháp được đề xuất trong nghiên cứu này dựa trên tiếp cận về đặc trưng kích thước và màu sắc của rầy nâu. Để xây dựng phương pháp này, chúng tôi sẽ tìm hiểu về đặc điểm hình thái cơ bản của rầy nâu để phân tích các đặc trưng kích thước và màu sắc của rầy nâu. Kết quả thực nghiệm cho thấy phương pháp này có thể giúp loại bỏ các loài côn trùng không phải rầy 
nâu trong ảnh và qua đó giúp tăng độ chính xác của giải thuật.
   Bài viết được chia thành năm phần. Phần thứ nhất giới thiệu về mối nguy hại của rầy nâu trong nông nghiệp và lý do dẫn đến hướng nghiên cứu này. Phần thứ hai sẽ tìm hiểu về đặc điểm hình thái của rầy nâu và các không gian màu trong ảnh kỹ thuật số. Phần thứ ba đề cập đến phương pháp loại bỏ các loại côn trùng không phải rầy nâu trong ảnh dựa trên phân tích đặc điểm kích thước và màu sắc của rầy nâu. Phần thứ tư trình bày kết quả thực nghiệm và đáng giá. Cuối cùng là phần kết luận.
   2 ĐẶC ĐIỂM HÌNH THÁI CỦA RẦY NÂU VÀ CÁC LOẠI KHÔNG GIAN MÀU TRONG ẢNH KỸ THUẬT SỐ
   Để có thể phân biệt rầy nâu và các côn trùng khác thường xuất hiện trong ảnh bẫy đèn, trước tiên chúng tôi tìm hiểu đặc điểm hình thái của rầy nâu và một số loại côn trùng khác. Hai đặc trưng cần phải tìm hiểu là kích thước và màu sắc của rầy nâu. Tiếp theo chúng tôi sẽ tìm hiểu về các không gian màu trong ảnh kỹ thuật số để kết hợp với đặc trưng màu sắc của rầy nâu để xác định vùng màu tương ứng trong ảnh kỹ thuật số. Đặc điểm hình thái của rầy nâu và các không gian màu cơ bản là cơ sở cho việc đề xuất giải pháp khử nhiễu cho phương pháp phát hiện rầy nâu dựa trên phép toán xử lý ảnh hình thái.
   2.1 Đặc điểm hình thái của rầy nâu
   Rầy nâu (Nilaparvata lugens) [9] là một trong những loài sâu bệnh gây ra dịch hại trên lúa nghiêm trọng nhất ở nước ta cũng như các vùng trồng lúa khác trên thế giới. Chúng gây hại trực tiếp bằng cách chích hút nhựa ở cây lúa làm giảm sức sống gây khô cháy toàn bộ cây lúa (gọi là hiện tượng "cháy rầy"). Rầy nâu còn là tác nhân gây ra nhiều bệnh rất nghiêm trọng ở cây lúa như bệnh lúa cỏ, lùn xoán lá... [9]
   Rầy nâu có cơ thể màu nâu vàng đỉnh đầu nhô ra phía trước. Phần gốc râu có hai đốt nở to, đốt roi râu dài và nhỏ. Cánh trong suốt, giữa cạnh sau của mỗi cánh trước có một đốm đen. Rầy đực có cơ thể dài từ 3,6 - 4,0 mm. Rầy cái màu xanh nhạt và kích thước to hơn rầy đực; chiều dài cơ thể từ 4 - 5 mm, bụng to tròn, ở khoảnh giữa mặt dưới bụng có bộ phận để trứng bén nhọn màu đen. Đặc điểm hình thái để nhận dạng rầy nâu phụ thuộc vào các giai đoạn phát triển của chúng. Trứng rầy nâu đẻ thành từng hàng vào bên trong bẹ cây lúa, trứng rầy giống hình hạt gạo, dài từ 0,3 - 0,4 mm, mới đẻ màu trắng trong (Hình 1a). Ấu trùng rầy nâu (rầy cám) khi mới nở rất nhỏ, màu trắng sữa, càng lớn rầy chuyển thành màu nâu nhạt (Hình 1b). Đặc điểm hình thái của rầy trưởng thành có sự khác nhau tùy vào từng loại: rầy cánh dài có cánh che phủ cả thân (Hình 1c); còn rầy cánh ngắn có cánh phủ đến đốt thứ 6 của thân mình (Hình 1d) [9].
   2.2 Các loại không gian màu trong ảnh kỹ thuật số
   2.2.1 Không gian màu RGB (Red, Green, Blue)
   Không gian màu RGB [11] là không gian màu được sử dụng phổ biến nhất trong các hình ảnh kỹ thuật số. Trong không gian màu này thì màu sắc của mỗi điểm ảnh sẽ được tổng hợp từ ba thành phần màu chính là đỏ (red), xanh lá (green) và xanh dương (blue). Ba màu sắc cơ bản này có thể kết hợp với nhau để tạo ra các màu sắc khác trong không gian màu.
   2.2.2 Không gian màu HLS (Hue, Luminance, Saturation)
   Không gian màu HLS [11] sử dụng ba thành phần cơ bản là sắc màu (hue), độ sáng (lumnance) và độ bão hòa màu (saturation). Trong đó, sắc màu (hue) là tên của màu sắc. Ví dụ đỏ, vàng, cam, tím... Còn độ sáng (luminance) là độ sáng của màu sắc, một màu sắc sẽ có những mức độ sáng khác nhau. Ví dụ màu vàng đậm, vàng thường, vàng nhạt. Thành phần cuối cùng là độ bão hòa màu (saturation) hay còn gọi là độ thuần khiết của màu. Màu sắc có độ thuần khiết càng lớn thì màu sắc càng gần với màu sắc thật của nó, ngược lại màu sắc có độ thuần khiết thấp thường mang sắc đen (tối hơn màu gốc).
   2.2.3 Chuyển đổi không gian màu RGB sang  không gian màu HLS
   Để chuyển đổi từ không gian màu RGB sang không gian màu HLS. Bước đầu tiên cần tìm độ sáng (luminance) của không gian màu HLS dựa trên không gian màu RGB với các thành phần màu R, G, B ∈ [0, 255]. Ta có:

   3 PHƯƠNG PHÁP LOẠI BỎ CÁC LOÀI CÔN TRÙNG KHÔNG PHẢI RẦY NÂU TRONG ẢNH 
   3.1 Phân tích đặc điểm kích thước của rầy nâu
   Đặc điểm kích thước của rầy nâu sẽ được phân tích dựa trên tập dữ liệu thực nghiệm. Trong bài báo này, chúng tôi sử dụng tập dữ liệu thực nghiệm là các hình ảnh về rầy nâu được chụp bởi camera pixy [12] có độ phân giải là 320x200 pixels, camera này sẽ được đặt vào bẫy đèn để ghi lại  hình ảnh rầy nâu vào bẫy đèn (Hình 2).

   Trong mô hình này thì khoảng cách giữa camera và mặt vuông đón rầy là 20 cm. Từ kích thước thật của rầy nâu (từ 3,6 - 5 mm)  đã được trình bày trong phần hai và khoảng cách giữa camera và mặt vuông đón rầy ta có thể xác định được kích thước của rầy nâu trong ảnh nằm trong khoảng từ 9 đến 40 pixels. Như vậy, có hai trường hợp cần giải quyết:
   * Trường hợp các loài côn trùng có kích thước nhỏ hơn kích thước của rầy nâu: các loài côn trùng có kích thước nhỏ hơn kích thước của rầy nâu sẽ được loại bỏ nhờ vào bước áp dụng phép toán hình thái trong mô hình phát hiện phổ quần thể rầy nâu [8].
   * Trường hợp các loài côn trùng có kích thước lớn hơn kích thước của rầy nâu: để loại bỏ các loài côn trùng có kích thước lớn hơn kích thước của rầy nâu, chúng ta sẽ loại bỏ các vùng có kích thước lớn hơn kích thước lớn nhất của rầy nâu, trong trường hợp này là 40 pixels.
   3.2 Phân tích đặc điểm màu sắc của rầy nâu
   Để loại bỏ các loài côn trùng không phải rầy nâu trong ảnh thì ngoài đặc điểm về kích thước, chúng tôi sẽ tiến hành phân tích thêm đặc điểm về màu sắc. Rầy nâu thường có màu nâu vàng nhưng do hình ảnh được ghi lại trong điều kiện trời tối nên làm cho màu sắc trong ảnh sẽ tối hơn trong điều kiện bình thường. Do đó, để xác định được mẫu màu của rầy nâu chính xác hơn, chúng tôi sẽ tiến hành phân tích một số mẫu màu sắc của rầy nâu trong các ảnh thực nghiệm để tìm ra đặc điểm màu sắc chung của rầy nâu. Tuy nhiên, các hình ảnh kỹ thuật số thường sử dụng không gian màu RGB để lưu trữ màu sắc ảnh, không gian màu này rất khó trong việc xác định họ màu. Ví dụ chúng ta sẽ khó xác định vùng màu nâu vàng thuộc khoảng giá trị nào của không gian màu RGB. Do đó, chúng tôi sẽ sử dụng không gian màu HLS để xác định đặc điểm màu sắc của rầy nâu. Lý do là trên không gian màu HLS thì có thể dựa vào giá trị sắc màu (hue) để thể xác định được vùng màu tương ứng, ví dụ như màu nâu vàng sẽ có giá trị sắc màu nằm trong vùng màu khoàng từ 0 - 40. Sau đây là bảng mô tả mười mẫu màu sắc của rầy nâu mà chúng 
tôi sẽ sử dụng để tiến hành phân tích mẫu màu (Bảng 1).

   Trong đó HLSPH là màu sắc của rầy nâu trong không gian màu HLS. HPH là sắc màu hay gọi 
là tên màu của rầy nâu trong không gian màu 
HLS, LPH là độ sáng của màu (luminance) trong không gian màu HLS còn SPH là độ bão hòa màu (saturation) của rầy nâu trong không gian màu HLS.
   3.3 Kết hợp đặc trưng kích thước và đặc trưng màu sắc để loại bỏ các loài côn trùng không phải rầy nâu trong ảnh
   Từ các phân tích về kích thước và màu sắc. Chúng tôi xây dựng nên giải thuật để loại bỏ côn trùng khỏi ảnh rầy nâu như sau:
   Giải thuật: Loại bỏ các loài côn trùng không phải rầy nâu trong ảnh
    Đầu vào: ảnh rầy nâu đã được phân vùng inImage.
    Đầu ra: ảnh sau khi loại bỏ các loài côn trùng không phải rầy nâu outImage.
    Các bước trong giải thuật:
    Bước 1: lần lượt duyệt qua các vùng trong ảnh rầy nâu đầu vào inImage. Sau đó lưu trữ kích thước từng vùng (theo đơn vị là pixel) và tính giá trị màu sắc trung bình trong vùng đó bằng cách cộng chỉ số màu của từng điểm ảnh theo từng giá trị đỏ (red), xanh lá (green) và màu xanh dương (blue) sau đó tính giá trị trung bình các giá trị này bằng cách chia từng giá trị cho tổng số điểm ảnh trong vùng tương ứng.
    
    Trong đó, RGBi là giá trị màu trung bình của vùng thứ i theo không gian màu RGB, Ri là giá trị trung bình của thành phần màu đỏ (red) tại vùng thứ i, Gi là giá trị trung bình của thành phần màu xanh lá (green) tại vùng thứ i, Bi là giá trị trung bình của thành phần màu xanh dương (blue) tại vùng thứ i, SumR là tổng giá trị của thành phần màu đỏ (red) tại vùng thứ i, SumG là tổng giá trị của thành phần màu xanh lá (green) tại vùng thứ i, SumB là tổng giá trị của thành phần màu xanh dương (blue) tại vùng thứ i, Sizei là kích thước hay tổng số điểm ảnh của vùng thứ i 
    Bước 2: Duyệt các vùng trong ảnh để loại bỏ các vùng không phải rầy nâu dựa trên hai đặc tính là kích thước của vùng và màu sắc trung bình của vùng. Như vậy, ta sẽ loại bỏ các vùng nếu thuộc một trong các trường hợp sau:
    - Nếu vùng có kích thước lớn hơn kích thước lớn nhất của rầy nâu (trong trường hợp này là 40 pixels) thì chúng ta sẽ loại bỏ vùng đó.
    - Nếu giá trị màu trung bình của vùng không thuộc giá trị vùng màu tương ứng của rầy nâu thì loại bỏ vùng đó. Để xét xem giá trị màu trung bình của vùng có thuộc giá trị vùng màu của rầy nâu hay không thì chúng ta cần chuyển đổi giá trị màu trung bình của vùng từ không gian màu RGB thành không gian màu HLS (tham khảo giải thuật trong phần 2.2.3) sau đó xét các giá trị trong không gian màu HLS với điều kiện như đã trình bày trong phần 3.2.
    Bước 3: Trả về ảnh kết quả outImage sau khi đã loại bỏ các loại côn trùng không phải rầy nâu ra khỏi ảnh đầu vào inImage và số lượng rầy trong ảnh.
   3.4 Phương pháp đánh giá
   Để đánh giá hiệu quả của phương pháp chúng tôi sẽ sử dụng các độ đo precision, recall và F1 [13]. Các độ đo này thường sử dụng để đánh giá hiệu quả của thuật toán nhận dạng như nhận dạng đường biên [14], phát hiện vùng nổi bật trong hình ảnh [15]. Trong trường hợp này, độ đo precision dùng để tính toán tỉ lệ rầy nâu tìm được chính xác  trong tổng số rầy nâu tìm được và được xác định bằng công thức:
   
   Độ đo recall dùng để tính toán tỉ lệ rầy nâu tìm được chính xác trong tổng số rầy nâu thực sự có trong ảnh và được xác định bằng công thức:
   
   Độ đo F1 là sự kết hợp của hai độ đo precision, recall và được xác định bằng công thức:
   
   4 THỰC NGHIỆM VÀ ĐÁNH GIÁ
   4.1 Dữ liệu thực nghiệm
   Sau khi đã đề xuất được phương pháp để loại bỏ các loại côn trùng không phải rầy nâu trong ảnh. Chúng tôi sẽ tiến hành áp dụng lên tập dữ liệu thực nghiệm để đánh giá phương pháp. Do ảnh về rầy nâu sẽ được chụp lại trong điều kiện buổi tối với ánh sáng đèn nên chúng tôi sẽ tạo ra các trường hợp ảnh khác nhau để thử nghiệm (Hình 3). Tập dữ liệu thực nghiệm là tập ảnh gồm 50 ảnh trong đó gồm 2 nhóm ảnh, mỗi nhóm sẽ có 25 ảnh. Nhóm thứ nhất là nhóm ảnh rầy nâu trong trường hợp ảnh có độ sáng phân bố đều, nhóm thứ hai là nhóm ảnh rầy nâu trong trường hợp ảnh có độ sáng phân bố không đều. Số lượng rầy nâu trong ảnh khoảng từ 50 đến gần 300 con, số lượng côn trùng trong ảnh khoảng từ 10 đến 15 con.

   4.2 Đánh giá thực nghiệm
   Để đánh giá kết quả thực nghiệm, chúng tôi sẽ 
tiến hành so sánh kết quả trước khi áp dụng phương pháp loại bỏ các loài côn trùng không 
phải rầy nâu trong ảnh và sau khi áp dụng phương pháp loại bỏ các loài côn trùng không phải rầy nâu trong ảnh (Bảng 2) để phát hiện số lượng rầy nâu trong ảnh.
   Dựa vào (Bảng 2), ta có thể thấy khi chưa áp dụng phương pháp loại bỏ các loài côn trùng không phải rầy nâu trong ảnh thì số lượng côn trùng bị phát hiện nhầm là rầy nâu khoảng 587 con với trường hợp độ sáng phân bố đều và 610 con với trường hợp độ sáng phân bố không đều, từ đó độ đo F1 thu được là 88,62% ứng với trường hợp có độ sáng phân bố đều và 88,07% ứng với trường hợp có độ sáng phân bố không đều. Trong khi đó, sau khi áp dụng phương pháp loại bỏ các loại côn trùng không phải rầy nâu trong ảnh thì số lượng côn trùng bị phát hiện nhầm là rầy nâu giảm còn 243 con với với trường hợp độ sáng phân bố đều và 241 con với trường hợp độ sang phân bố không đều, độ đo F1 thu được tăng lên 92,96% ứng với trường hợp có độ sáng phân bố đều và 92,71% ứng với trường hợp có độ sáng phân bố không đều.
   Như vậy, phương pháp loại bỏ các loài côn trùng không phải rầy nâu khỏi ảnh giúp tăng hiệu quả của mô hình phát hiện phổ quần thể rầy nâu trong trường hợp có sự xuất hiện của các loài côn trùng không phải rầy nâu trong ảnh từ đó giúp tăng độ chính xác của mô hình.
   5 KẾT LUẬN
   Chúng tôi đã đề xuất được một phương pháp giúp hạn chế sự ảnh hưởng của các loài côn trùng không phải rầy nâu trong ảnh làm giảm tính chính xác của mô hình phát hiện rầy nâu. Phương pháp này sẽ cho phép loại bỏ các loài côn trùng không phải rầy nâu trong ảnh dựa trên hai đặc trưng cơ bản của rầy nâu là đặc trưng về kích thước và đặc trưng về màu sắc. Kết quả khi áp dụng phương pháp này vào mô hình phát hiện phổ quần thể rầy nâu trong ảnh cho kết quả tốt tuy nhiên vẫn còn có sự phát hiện nhầm các côn trùng khác là rầy nâu.
   TÀI LIỆU THAM KHẢO
1. K. E. Mueller, E. A. Heinrich, J. A. Litsinger, F. N. ponnamperuma, K. Moody, S. K. De Datta, 1983. Những thiệt hại trên ruộng lúa nhiệt đới (xuất bản lần hai), Viện Nghiên cứu Lúa gạo Quốc tế (IRRI).
